---
import { ReactUserProfile } from '@kbve/astropad';
---

<style>
	@keyframes shimmer {
		0% {
			background-position: -200% 0;
		}
		100% {
			background-position: 200% 0;
		}
	}

	/* Neoglass panel using proper starlight variables */
	[data-neoglass-panel] {
		--panel-bg: color-mix(in srgb, var(--sl-color-white) 5%, transparent);
		--panel-border: color-mix(in srgb, var(--sl-color-white) 10%, transparent);
		--panel-hover-bg: color-mix(in srgb, var(--sl-color-white) 8%, transparent);
		--panel-hover-ring: color-mix(in srgb, var(--sl-color-accent) 30%, transparent);
		--glow-border: color-mix(in srgb, var(--sl-color-accent) 10%, transparent);
		--glow-hover-border: color-mix(in srgb, var(--sl-color-accent) 30%, transparent);
		--drop-shadow-color: color-mix(in srgb, var(--sl-color-accent) 60%, transparent);
	}

	/* Light theme adjustments */
	[data-theme="light"] [data-neoglass-panel] {
		--panel-bg: color-mix(in srgb, var(--sl-color-black) 5%, transparent);
		--panel-border: color-mix(in srgb, var(--sl-color-black) 10%, transparent);
		--panel-hover-bg: color-mix(in srgb, var(--sl-color-black) 8%, transparent);
		--drop-shadow-color: color-mix(in srgb, var(--sl-color-accent) 40%, transparent);
	}

	[data-neoglass-panel]:hover {
		background-color: var(--panel-hover-bg);
		border-color: var(--panel-hover-ring);
	}

	[data-neoglass-panel]:hover [data-neoglass-glow] {
		border-color: var(--glow-hover-border);
	}

	/* Skeleton shimmer using starlight variables */
	.skeleton-shimmer {
		background: linear-gradient(90deg, 
			color-mix(in srgb, var(--sl-color-gray-5) 40%, transparent), 
			color-mix(in srgb, var(--sl-color-gray-4) 60%, transparent), 
			color-mix(in srgb, var(--sl-color-gray-5) 40%, transparent)
		);
		background-size: 200% 100%;
		animation: shimmer 2s infinite;
	}

	.skeleton-accent {
		background: color-mix(in srgb, var(--sl-color-accent) 60%, transparent);
	}

	.skeleton-surface {
		background: color-mix(in srgb, var(--sl-color-gray-5) 60%, transparent);
	}

	.skeleton-avatar-bg {
		background: color-mix(in srgb, var(--sl-color-accent-low) 20%, transparent);
		border: 1px solid color-mix(in srgb, var(--sl-color-accent) 30%, transparent);
	}
</style>

<section class="py-4 min-h-[700px]">
	<div
		data-neoglass-panel
		class="profile-container mx-auto max-w-7xl relative rounded-3xl backdrop-blur-md ring-1
		shadow-[inset_0_0_0.5px_rgba(255,255,255,0.15),inset_0_1px_0_rgba(255,255,255,0.08),0_20px_40px_rgba(0,0,0,0.4)]
		hover:shadow-[inset_0_0_1px_rgba(255,255,255,0.2),inset_0_2px_1px_rgba(255,255,255,0.1),0_30px_60px_rgba(0,0,0,0.5)]
		transition-all duration-300 ease-out overflow-hidden ring-offset-1 ring-offset-white/5 group
		will-change-transform"
		style="background-color: var(--panel-bg); border-color: var(--panel-border);">
		
		<!-- Enhanced glow effect -->
		<div
			data-neoglass-glow
			class="absolute inset-[14px] rounded-[1.375rem] pointer-events-none z-10 border
			shadow-[inset_0.5px_0.5px_1.5px_rgba(186,230,253,0.6),inset_-1px_-1px_1px_rgba(21,94,117,0.5),inset_3px_3px_6px_rgba(0,0,0,0.25)]
			group-hover:shadow-[inset_0.5px_0.5px_2px_rgba(186,230,253,0.8),inset_-1px_-1px_1.5px_rgba(21,94,117,0.7),inset_3px_3px_8px_rgba(0,0,0,0.3)]
			transition-all duration-300 ease-out"
			style="border-color: var(--glow-border); filter: drop-shadow(0 0 calc(var(--glow-intensity, 0.4) * 10px) var(--drop-shadow-color));">
		</div>
		
		<!-- Profile skeleton loader -->
		<div class="profile-skeleton p-8 relative z-20" data-skeleton="user-profile">
			<div class="space-y-6">
				<!-- Header with user info -->
				<div class="flex items-center justify-between mb-8">
					<div class="flex items-center gap-4">
						<!-- Avatar skeleton -->
						<div class="skeleton-avatar-bg relative w-16 h-16 rounded-full overflow-hidden">
							<div class="skeleton-shimmer absolute inset-0"></div>
							<div class="flex items-center justify-center w-full h-full relative z-10">
								<div class="skeleton-surface w-8 h-8 rounded"></div>
							</div>
						</div>
						
						<!-- Welcome text -->
						<div class="space-y-2">
							<div class="skeleton-shimmer w-48 h-6 rounded" style="animation-delay: 0.1s;"></div>
							<div class="skeleton-shimmer w-32 h-4 rounded" style="animation-delay: 0.3s;"></div>
						</div>
					</div>
				</div>
				
				<!-- Profile panels grid -->
				<div class="w-full max-w-6xl mx-auto min-h-[500px]">
					<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
						<!-- Profile panel skeleton items -->
						<div class="p-2">
							<div class="skeleton-shimmer relative w-full h-[100px] rounded-xl overflow-hidden">
								<div class="p-4 flex flex-col justify-between h-full">
									<div class="skeleton-accent w-6 h-6 rounded"></div>
									<div class="skeleton-surface mt-2 w-20 h-4 rounded"></div>
									<div class="skeleton-surface w-32 h-3 rounded"></div>
								</div>
							</div>
						</div>
						
						<div class="p-2">
							<div class="skeleton-shimmer relative w-full h-[100px] rounded-xl overflow-hidden" style="animation-delay: 0.2s;">
								<div class="p-4 flex flex-col justify-between h-full">
									<div class="skeleton-accent w-6 h-6 rounded"></div>
									<div class="skeleton-surface mt-2 w-20 h-4 rounded"></div>
									<div class="skeleton-surface w-32 h-3 rounded"></div>
								</div>
							</div>
						</div>
						
						<div class="p-2">
							<div class="skeleton-shimmer relative w-full h-[100px] rounded-xl overflow-hidden" style="animation-delay: 0.4s;">
								<div class="p-4 flex flex-col justify-between h-full">
									<div class="skeleton-accent w-6 h-6 rounded"></div>
									<div class="skeleton-surface mt-2 w-20 h-4 rounded"></div>
									<div class="skeleton-surface w-32 h-3 rounded"></div>
								</div>
							</div>
						</div>
						
						<div class="p-2">
							<div class="skeleton-shimmer relative w-full h-[100px] rounded-xl overflow-hidden" style="animation-delay: 0.6s;">
								<div class="p-4 flex flex-col justify-between h-full">
									<div class="skeleton-accent w-6 h-6 rounded"></div>
									<div class="skeleton-surface mt-2 w-20 h-4 rounded"></div>
									<div class="skeleton-surface w-32 h-3 rounded"></div>
								</div>
							</div>
						</div>
						
						<div class="p-2">
							<div class="skeleton-shimmer relative w-full h-[100px] rounded-xl overflow-hidden" style="animation-delay: 0.8s;">
								<div class="p-4 flex flex-col justify-between h-full">
									<div class="skeleton-accent w-6 h-6 rounded"></div>
									<div class="skeleton-surface mt-2 w-20 h-4 rounded"></div>
									<div class="skeleton-surface w-32 h-3 rounded"></div>
								</div>
							</div>
						</div>
						
						<div class="p-2">
							<div class="skeleton-shimmer relative w-full h-[100px] rounded-xl overflow-hidden" style="animation-delay: 1s;">
								<div class="p-4 flex flex-col justify-between h-full">
									<div class="skeleton-accent w-6 h-6 rounded"></div>
									<div class="skeleton-surface mt-2 w-20 h-4 rounded"></div>
									<div class="skeleton-surface w-32 h-3 rounded"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- React component overlay -->
		<ReactUserProfile client:only="react" />
	</div>
</section>

<style>
	/* Profile container positioning and transitions */
	.profile-container {
		position: relative;
		min-height: 700px;
	}
	
	.profile-skeleton {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		opacity: 1;
		z-index: 30;
		transition: opacity 0.3s ease-in-out;
	}
	
	.profile-skeleton.fade-out {
		opacity: 0;
		pointer-events: none;
	}
	
	/* React component overlay */
	.profile-container > :last-child {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		opacity: 0;
		z-index: 40;
		transition: opacity 0.3s ease-in-out;
	}
	
	.profile-container.hydrated > :last-child {
		opacity: 1;
	}

	.profile-container.hydrated .profile-skeleton {
		opacity: 0;
		pointer-events: none;
	}
</style>