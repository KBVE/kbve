---
/** @jsxImportSource astro */
// Navigation.astro - Professional navigation with shimmer skeletons
import ReactNav from './template/nav/ReactNav';

export interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<!-- Navigation Container -->
<nav class={`w-full bg-gray-900/95 backdrop-blur-md border-b border-gray-800 sticky top-0 z-50 ${className}`}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      
      <!-- Logo (Static) -->
      <div class="flex-shrink-0">
        <a href="/" class="flex items-center gap-2 group" aria-label="Discord.sh Home" data-astro-prefetch>
          <img 
            src="/assets/media/logo/discordsh_logo.webp" 
            alt="Discord.sh" 
            class="h-12"
          />
          <span class="hidden sm:block text-white font-semibold text-lg group-hover:text-purple-400 transition-colors duration-300">
            Discord.sh
          </span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center gap-1">
        <!-- Navigation Items with Skeletons -->
        <div data-nav="desktop-menu" class="flex items-center gap-1">
          
          <!-- Home -->
          <div data-nav-item="home" class="relative group">
            <!-- Skeleton -->
            <div data-skeleton="home" class="p-2 rounded-lg nav-skeleton">
              <div class="w-5 h-5 bg-gray-700 rounded"></div>
            </div>
            <!-- Actual Content -->
            <a 
              href="/" 
              data-content="home"
              class="hidden flex items-center justify-center p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all duration-200"
              data-astro-prefetch
            >
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"/>
                <path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              </svg>
            </a>
            <!-- Tooltip -->
            <div data-tooltip="home" class="absolute left-1/2 -translate-x-1/2 top-full mt-1 px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
              <span data-tooltip-text="home">Home</span>
              <div class="absolute w-2 h-2 bg-gray-800 transform rotate-45 -top-1 left-1/2 -translate-x-1/2"></div>
            </div>
          </div>

          <!-- Servers -->
          <div data-nav-item="servers" class="relative group">
            <!-- Skeleton -->
            <div data-skeleton="servers" class="p-2 rounded-lg nav-skeleton">
              <div class="w-5 h-5 bg-gray-700 rounded"></div>
            </div>
            <!-- Actual Content -->
            <a 
              href="/servers" 
              data-content="servers"
              class="hidden flex items-center justify-center p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all duration-200"
              data-astro-prefetch
            >
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect width="20" height="8" x="2" y="14" rx="2"/>
                <path d="M6 18h.01M10 18h.01M6 10h.01M10 10h.01M6 6h.01M10 6h.01"/>
                <path d="M13 6v12M19 10v8"/>
              </svg>
            </a>
            <!-- Tooltip -->
            <div data-tooltip="servers" class="absolute left-1/2 -translate-x-1/2 top-full mt-1 px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
              <span data-tooltip-text="servers">Servers</span>
              <div class="absolute w-2 h-2 bg-gray-800 transform rotate-45 -top-1 left-1/2 -translate-x-1/2"></div>
            </div>
          </div>

          <!-- Features -->
          <div data-nav-item="features" class="relative group">
            <!-- Skeleton -->
            <div data-skeleton="features" class="p-2 rounded-lg nav-skeleton">
              <div class="w-5 h-5 bg-gray-700 rounded"></div>
            </div>
            <!-- Actual Content -->
            <a 
              href="/features" 
              data-content="features"
              class="hidden flex items-center justify-center p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all duration-200"
              data-astro-prefetch
            >
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
              </svg>
            </a>
            <!-- Tooltip -->
            <div data-tooltip="features" class="absolute left-1/2 -translate-x-1/2 top-full mt-1 px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
              <span data-tooltip-text="features">Features</span>
              <div class="absolute w-2 h-2 bg-gray-800 transform rotate-45 -top-1 left-1/2 -translate-x-1/2"></div>
            </div>
          </div>

          <!-- Pricing -->
          <div data-nav-item="pricing" class="relative group">
            <!-- Skeleton -->
            <div data-skeleton="pricing" class="p-2 rounded-lg nav-skeleton">
              <div class="w-5 h-5 bg-gray-700 rounded"></div>
            </div>
            <!-- Actual Content -->
            <a 
              href="/pricing" 
              data-content="pricing"
              class="hidden flex items-center justify-center p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all duration-200"
              data-astro-prefetch
            >
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8M12 18V6"/>
              </svg>
            </a>
            <!-- Tooltip -->
            <div data-tooltip="pricing" class="absolute left-1/2 -translate-x-1/2 top-full mt-1 px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
              <span data-tooltip-text="pricing">Pricing</span>
              <div class="absolute w-2 h-2 bg-gray-800 transform rotate-45 -top-1 left-1/2 -translate-x-1/2"></div>
            </div>
          </div>

          <!-- Documentation -->
          <div data-nav-item="docs" class="relative group">
            <!-- Skeleton -->
            <div data-skeleton="docs" class="p-2 rounded-lg nav-skeleton">
              <div class="w-5 h-5 bg-gray-700 rounded"></div>
            </div>
            <!-- Actual Content -->
            <a 
              href="/docs" 
              data-content="docs"
              class="hidden flex items-center justify-center p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all duration-200"
              data-astro-prefetch
            >
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
              </svg>
            </a>
            <!-- Tooltip -->
            <div data-tooltip="docs" class="absolute left-1/2 -translate-x-1/2 top-full mt-1 px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
              <span data-tooltip-text="docs">Documentation</span>
              <div class="absolute w-2 h-2 bg-gray-800 transform rotate-45 -top-1 left-1/2 -translate-x-1/2"></div>
            </div>
          </div>
        </div>

        <!-- Menu Button for Desktop -->
        <div data-nav-item="menu" class="relative group">
          <!-- Skeleton -->
          <div data-skeleton="menu" class="p-2 rounded-lg nav-skeleton">
            <div class="w-5 h-5 bg-gray-700 rounded"></div>
          </div>
          <!-- Actual Content -->
          <button 
            data-content="menu"
            data-nav="desktop-menu-toggle"
            class="hidden flex items-center justify-center p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all duration-200"
          >
            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="3" y1="12" x2="21" y2="12"/>
              <line x1="3" y1="6" x2="21" y2="6"/>
              <line x1="3" y1="18" x2="21" y2="18"/>
            </svg>
          </button>
          <!-- Tooltip -->
          <div data-tooltip="menu" class="absolute left-1/2 -translate-x-1/2 top-full mt-1 px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
            <span data-tooltip-text="menu">Menu</span>
            <div class="absolute w-2 h-2 bg-gray-800 transform rotate-45 -top-1 left-1/2 -translate-x-1/2"></div>
          </div>
        </div>

        <!-- Divider -->
        <div class="h-6 w-px bg-gray-700 mx-2"></div>

        <!-- User Section -->
        <div data-nav="user-section" class="flex items-center gap-3">
          <!-- Avatar Skeleton -->
          <div data-skeleton="avatar" class="p-2 rounded-lg nav-skeleton">
            <div class="w-8 h-8 bg-gray-700 rounded-full"></div>
          </div>
          
          <!-- Guest Links (hidden by default) -->
          <div data-content="guest-links" class="hidden items-center gap-2">
            <a 
              href="/login"
              class="px-4 py-1.5 text-sm font-medium text-gray-300 hover:text-white transition-colors duration-200"
              data-astro-prefetch
            >
              Sign In
            </a>
            <a 
              href="/register"
              class="px-4 py-1.5 text-sm font-medium bg-purple-600 text-white rounded-full hover:bg-purple-500 transition-colors duration-200"
              data-astro-prefetch
            >
              Register
            </a>
          </div>

          <!-- User Avatar (hidden by default) -->
          <button 
            data-content="user-avatar"
            class="hidden relative group"
            aria-label="User menu"
          >
            <div class="flex items-center gap-2">
              <div class="relative">
                <img 
                  data-user-image
                  class="w-8 h-8 rounded-full ring-2 ring-gray-700 group-hover:ring-purple-500/50 transition-all duration-200 hidden"
                  alt="User"
                />
                <div 
                  data-user-initials
                  class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 ring-2 ring-gray-700 group-hover:ring-purple-500/50 flex items-center justify-center text-white font-medium text-sm transition-all duration-200 hidden"
                >
                  U
                </div>
                <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full ring-2 ring-gray-900"></span>
              </div>
            </div>
          </button>
        </div>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden flex items-center gap-2">
        <!-- Mobile Avatar -->
        <div data-nav="mobile-avatar">
          <!-- Avatar Skeleton -->
          <div data-skeleton="mobile-avatar" class="p-2 rounded-lg nav-skeleton">
            <div class="w-8 h-8 bg-gray-700 rounded-full"></div>
          </div>
          
          <!-- Guest Avatar -->
          <a 
            href="/login"
            data-content="mobile-guest-avatar"
            class="hidden p-1"
            aria-label="Sign in"
            data-astro-prefetch
          >
            <svg class="w-8 h-8 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
          </a>

          <!-- User Avatar -->
          <button 
            data-content="mobile-user-avatar"
            class="hidden relative"
            aria-label="User menu"
          >
            <img 
              data-mobile-user-image
              class="w-8 h-8 rounded-full ring-2 ring-gray-700 hidden"
              alt="User"
            />
            <div 
              data-mobile-user-initials
              class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 ring-2 ring-gray-700 flex items-center justify-center text-white font-medium text-sm hidden"
            >
              U
            </div>
          </button>
        </div>

        <!-- Mobile Menu Toggle -->
        <button 
          data-nav="mobile-menu-toggle"
          class="p-2 text-gray-400 hover:text-white transition-colors duration-200"
          aria-label="Menu"
        >
          <!-- Skeleton -->
          <div data-skeleton="mobile-menu" class="p-2 rounded-lg nav-skeleton">
            <div class="w-6 h-6 bg-gray-700 rounded"></div>
          </div>
          <!-- Hamburger Icon -->
          <svg data-content="mobile-menu-icon" class="w-6 h-6 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"/>
            <line x1="3" y1="6" x2="21" y2="6"/>
            <line x1="3" y1="18" x2="21" y2="18"/>
          </svg>
          <!-- Close Icon -->
          <svg data-content="mobile-close-icon" class="w-6 h-6 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Off-Canvas Modals -->
  
  <!-- Off-Canvas Menu -->
  <div 
    data-modal="offcanvas"
    class="fixed inset-0 z-50 hidden"
  >
    <!-- Backdrop -->
    <div data-modal-backdrop class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div>
    
    <!-- Menu Panel -->
    <div data-modal-panel class="absolute right-0 top-0 h-full w-80 bg-gray-900 shadow-2xl transform translate-x-full transition-transform duration-300">
      <div class="flex flex-col h-full">
        <!-- Header -->
        <div class="flex items-center justify-between p-4 border-b border-gray-800">
          <h2 data-modal-title class="text-lg font-semibold text-white">Menu</h2>
          <button data-modal-close class="p-1 text-gray-400 hover:text-white">
            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <!-- Dynamic Content -->
        <div class="flex-1 p-4 overflow-y-auto">
          <div data-modal-content></div>
        </div>
      </div>
    </div>
  </div>

  <!-- React Navigation Controller -->
  <ReactNav client:only="react" />
</nav>

<style>
  /* Shimmer effect for skeletons */
  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  .nav-skeleton {
    background: linear-gradient(
      90deg,
      #374151 25%,
      #4b5563 50%,
      #374151 75%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite ease-in-out;
  }
</style>