---
import { clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export interface Props {
  title: string;
  subtitle?: string;
  description?: string;
  span?: string;
  primaryColor: string;
  secondaryColor: string;
  icon?: string;
  backgroundImage?: string;
  onclick?: string;
}

const {
  title,
  subtitle,
  description,
  span = 'col-span-2 row-span-1',
  primaryColor,
  secondaryColor,
  icon,
  backgroundImage,
  onclick,
} = Astro.props;

const isLargeTile = span.includes('col-span-3') || span.includes('row-span-3');

const classes = twMerge(clsx(
  'bento-item bento-reflection relative overflow-hidden rounded-2xl shadow-2xl hover:scale-[1.01] transition-all duration-300 cursor-pointer group animate-fade-in',
  span,
  `bg-gradient-to-br from-${primaryColor} to-${secondaryColor}`,
  `drop-shadow-${primaryColor}/40 drop-shadow-xl`,
  `hover:drop-shadow-${secondaryColor}/60 drop-shadow-2xl`
));
---

<div class={classes} onclick={onclick}>
  {backgroundImage && (
    <div
      class="bento-bg-image absolute inset-0 z-[-1] bg-cover bg-center"
      style={`background-image: url('${backgroundImage}')`}
    />
  )}
  <div class="bento-glow absolute inset-0 z-0 transition" style={`opacity: ${isLargeTile ? '0.08' : '0.04'}`}></div>
  <div class="noise-overlay"></div>
  <div class="absolute inset-0 bg-black/10 backdrop-blur-sm group-hover:bg-black/20 transition z-0"></div>
  <span class="absolute inset-y-0 right-0 w-16 transform translate-x-20 bg-white/20 opacity-20 rotate-12 transition-transform duration-1000 ease-out group-hover:-translate-x-64 pointer-events-none"></span>
  <div class="relative z-10 p-4 h-full flex flex-col justify-between">
    <div class="flex items-center gap-3">
      {icon && <div class="text-2xl sm:text-3xl bg-white/20 rounded-full p-2 backdrop-blur-sm shadow text-white">{icon}</div>}
      <h3 class="text-lg sm:text-xl font-bold text-white">{title}</h3>
    </div>
    {subtitle && <p class="text-sm text-white/80 group-hover:text-white mt-3 leading-snug">{subtitle}</p>}
    {description && <p class="text-xs text-white/70 mt-2 leading-snug">{description}</p>}
  </div>
</div>
